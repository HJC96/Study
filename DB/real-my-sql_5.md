### 1. Stored Function의 속성: `DETERMINISTIC` vs `NOT DETERMINISTIC`

이 두 속성은 함수의 결과가 확정적인지 아닌지를 정의하며, 쿼리 성능에 결정적인 영향을 미칩니다.

* **`DETERMINISTIC` (확정적)**
    * **정의:** 입력(인자 + 참조 데이터)이 같으면 **항상 같은 결과**를 반환함.
    * **동작:** 쿼리 내에서 한 번만 호출되거나 최적화되어 상수처럼 처리될 수 있음.
    * **성능:** 인덱스를 효율적으로 사용할 수 있어 **빠름.**
* **`NOT DETERMINISTIC` (비확정적)**
    * **정의:** 입력이 같아도 호출 시점에 따라 **결과가 달라질 수 있음** (기본값).
    * **동작:** 레코드를 읽을 때마다 매번 함수를 새로 호출하여 값을 비교함.
    * **성능:** 인덱스를 사용하지 못하고 **풀 테이블 스캔(Full Table Scan)**을 유발하여 **매우 느림.**

### 2. 성능 비교 실험 결과
* 동일한 로직의 함수라도 `NOT DETERMINISTIC`으로 선언하면, `WHERE` 절에서 사용될 때 매 레코드마다 실행되어 호출 횟수가 폭증하고 인덱스를 타지 않음.
* **권장:** Stored Function을 만들 때는 **반드시 `DETERMINISTIC` 속성을 명시**해야 성능 저하를 막을 수 있음 (기본값이 `NOT DETERMINISTIC`임).

### 3. Built-in Function의 함정: `NOW()` vs `SYSDATE()`

MySQL 내장 함수들도 이 속성을 따르며, 특히 날짜 함수에서 주의가 필요합니다.

| 함수 | 속성 | 특징 | 인덱스 사용 |
| :--- | :--- | :--- | :--- |
| **`NOW()`** | **Deterministic** (처럼 동작) | 쿼리가 시작되는 시점의 시간을 반환. 쿼리 내에서 **값이 변하지 않음.** | **가능 (O)** |
| **`SYSDATE()`** | **Not Deterministic** | 함수가 호출되는 시점의 시간을 반환. 레코드마다 **값이 달라질 수 있음.** | **불가능 (X)** |

* **문제점:** `SYSDATE()`를 사용하면 인덱스를 타지 않아 풀 스캔이 발생하고 성능이 급격히 저하됨.
* **해결책:**
    1.  가능하면 `NOW()`를 사용.
    2.  `sysdate-is-now` 옵션을 설정 파일(`my.cnf`)에 추가하여 `SYSDATE()`도 `NOW()`처럼 동작하게 강제할 수 있음.

**요약 핵심:**
Stored Function을 정의할 때는 성능을 위해 꼭 **`DETERMINISTIC`**을 명시하세요. 또한 날짜 비교 시에는 인덱스를 탈 수 있는 **`NOW()`**를 사용하고, 성능 킬러인 `SYSDATE()`는 피하는 것이 좋습니다.
